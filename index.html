<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Welcome to my personal website!">
    <title>Shine dynamic price</title>
    <style>
       body {
           font-family: Arial, sans-serif;
           background-color: #E0F7FA; /* Lighter blue */
           margin: 0;
           padding: 0;
       }

       header {
           background-color: #B0E0E6; /* Powder Blue */
           color: #000; /* Dark text for contrast */
           padding: 1rem;
           text-align: center;
       }

       nav {
           display: flex;
           justify-content: center;
           background-color: #444;
           padding: 1rem;
       }

       nav a {
           color: white;
           text-decoration: none;
           margin: 0 15px;
           font-weight: bold;
       }

       nav a:hover {
           color: #ff9900;
       }

       section {
           margin: 20px;
           padding: 20px;
           background: #87CEEB;
           border-radius: 8px;
           box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
       }

       footer {
           background-color: #B0E0E6; /* Powder Blue */
           color: #000; /* Dark text for contrast */
           padding: 1rem;
           text-align: center;
       }

       /* CSS to position the image in the top-left */
       img.logo {
           position: absolute;
           top: 20px;
           left: 20px;
           width: 200px; /* Adjust size as needed */
       }
    </style>
</head>
<body>
   <!-- Add the image here -->
    <img src="SHINETECH-300-Pixel-SVG.svg" alt="Shinetech Logo" class="logo">

    <header>
        <h1>Dynamic Electricity Price</h1>
    </header>

    <nav>
        <a href="#">Home</a>
        <a href="#">About</a>
        <a href="#">Projects</a>
        <a href="#">Contact</a>
    </nav>

    <section>
        <h2>Current Dynamic Electricity Price</h2>
        <!-- Line added above date and time -->
        <p>Here you will get the current dynamic electricity price taken from the Tibber App.</p>
        <p id="datetime"></p>
        <p id="electricity-price">Fetching the latest electricity price...</p>
    </section>

    <section>
        <h2>Contact Us</h2>
        <p>
            Reach us at <a href="mailto:info@shinetech.com.com">info@shinetech.de</a>.
        </p>
    </section>

    <footer>
        <p>&copy; 2024 My Website. All rights reserved.</p>
    </footer>

    <!-- JavaScript to display current date and time -->
    <script>
        function updateDateTime() {
            var now = new Date();
            var options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
            var formattedDateTime = now.toLocaleDateString('en-US', options);
            document.getElementById("datetime").innerHTML = "Current date and time: " + formattedDateTime;
        }

        // Update the date and time immediately when the page loads
        updateDateTime();
        // Update the date and time every second
        setInterval(updateDateTime, 1000);

        // Function to fetch electricity price from Tibber API
        async function fetchElectricityPrice() {
            const demoToken = "5K4MVS-OjfWhK_4yrjOlFe1F6kJXPVf7eQYggo8ebAE";  // Tibber demo token
            const query = `
                {
                  viewer {
                    homes {
                      currentSubscription {
                        priceInfo {
                          current {
                            total
                            energy
                            tax
                            startsAt
                          }
                        }
                      }
                    }
                  }
                }
            `;

            try {
                const response = await fetch('https://api.tibber.com/v1-beta/gql', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${demoToken}`
                    },
                    body: JSON.stringify({ query })
                });

                const data = await response.json();
                const priceInfo = data.data.viewer.homes[0].currentSubscription.priceInfo.current;
                let price = priceInfo.total;  // Total price including tax and energy
                price = (price * 100).toFixed(2);  // Convert EUR to Cents and format to 2 decimal places
                const time = new Date(priceInfo.startsAt).toLocaleTimeString();

                // Display the fetched price on the webpage (now in Cents)
                document.getElementById('electricity-price').innerHTML = `Current dynamic price: ${price} Cent/kWh`;
            } catch (error) {
                document.getElementById('electricity-price').innerHTML = 'Error fetching the electricity price.';
                console.error('Error:', error);
            }
        }

        // Fetch the Tibber electricity price when the page loads
        fetchElectricityPrice();
    </script>

</body>
</html>
